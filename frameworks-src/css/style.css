/* ============================================================
   思考・発想フレームワーク集 — style.css
   PC  : サイドバー + スライド形式
   SP  : 縦スクロール + ドロワー目次
   ============================================================ */

:root {
  --ink:      #0f0e0c;
  --paper:    #f5f0e8;
  --bg:       #161412;
  --c1:       #c94a2c;
  --c2:       #1a4a7a;
  --c3:       #2d7a4a;
  --c4:       #7a4a1a;
  --c5:       #5a2d7a;
  --muted:    #8a8070;
  --line:     #d0c8b8;
  --sidebar-w: 280px;
  --header-h:  52px;
}

* { margin: 0; padding: 0; box-sizing: border-box; }
html { height: 100%; }
body {
  /* dvh: iPhoneのアドレスバー出し入れによる高さ変動を受けない */
  height: 100dvh;
  overflow: hidden;
  font-family: 'Noto Sans JP', sans-serif;
  background: var(--bg);
  color: var(--ink);
  display: flex;
  flex-direction: column;
}

/* ============================================================
   TOP HEADER
   ============================================================ */
#top-header {
  height: var(--header-h);
  background: #0a0908;
  border-bottom: 1px solid #2a2520;
  display: flex;
  align-items: center;
  padding: 0 16px;
  gap: 12px;
  flex-shrink: 0;
  z-index: 200;
}
#toc-toggle {
  width: 36px; height: 36px;
  border: 1px solid #333;
  background: transparent;
  color: #888;
  cursor: pointer;
  display: flex; align-items: center; justify-content: center;
  flex-shrink: 0;
  transition: all .2s;
  font-size: 16px;
}
#toc-toggle:hover { border-color: #666; color: #ccc; }
#toc-toggle.open  { border-color: var(--paper); color: var(--paper); background: #1a1814; }
.header-title {
  font-family: 'Space Mono', monospace;
  font-size: 11px; color: #555; letter-spacing: .15em; flex-shrink: 0;
}
.cat-tabs { display: flex; gap: 3px; flex: 1; overflow-x: auto; scrollbar-width: none; }
.cat-tabs::-webkit-scrollbar { display: none; }
.cat-tab {
  font-family: 'Space Mono', monospace;
  font-size: 10px; padding: 5px 11px;
  border: 1px solid #2a2520; background: transparent; color: #555;
  cursor: pointer; transition: all .18s; white-space: nowrap;
}
.cat-tab:hover  { color: #aaa; border-color: #444; }
.cat-tab.active { background: var(--paper); color: var(--ink); border-color: var(--paper); }
.header-counter { font-family: 'Space Mono', monospace; font-size: 11px; color: #444; flex-shrink: 0; }

/* ============================================================
   MAIN LAYOUT
   ============================================================ */
#main { flex: 1; display: flex; overflow: hidden; position: relative; }

/* ============================================================
   SIDEBAR
   ============================================================ */
#sidebar {
  width: var(--sidebar-w);
  background: #0d0c0a;
  border-right: 1px solid #1e1c18;
  overflow-y: auto;
  flex-shrink: 0;
  transition: width .25s ease, opacity .25s ease;
  display: flex; flex-direction: column;
  z-index: 100;
}
#sidebar.closed { width: 0; opacity: 0; overflow: hidden; pointer-events: none; }
#sidebar::-webkit-scrollbar { width: 4px; }
#sidebar::-webkit-scrollbar-track { background: #0d0c0a; }
#sidebar::-webkit-scrollbar-thumb { background: #2a2520; border-radius: 2px; }

.sb-head { padding: 20px 18px 12px; border-bottom: 1px solid #1e1c18; flex-shrink: 0; }
.sb-head-title { font-family: 'Space Mono', monospace; font-size: 9px; color: #444; letter-spacing: .2em; margin-bottom: 4px; }
.sb-head-sub { font-size: 12px; color: #888; }
.sb-section { border-bottom: 1px solid #1a1814; }
.sb-section-header { display: flex; align-items: center; gap: 10px; padding: 12px 18px 10px; cursor: pointer; user-select: none; }
.sb-section-bar { width: 3px; height: 16px; border-radius: 1px; flex-shrink: 0; }
.sb-section-name { font-family: 'Space Mono', monospace; font-size: 9px; color: #666; letter-spacing: .12em; flex: 1; }
.sb-section-arrow { font-size: 9px; color: #444; transition: transform .2s; }
.sb-section.collapsed .sb-section-arrow { transform: rotate(-90deg); }
.sb-items { padding: 0 0 8px; }
.sb-section.collapsed .sb-items { display: none; }
.sb-divider-label { padding: 10px 18px 3px; font-family: 'Space Mono', monospace; font-size: 9px; color: #3a3830; letter-spacing: .1em; cursor: pointer; transition: color .15s; }
.sb-divider-label:hover { color: #666; }
.sb-item { display: flex; align-items: flex-start; gap: 10px; padding: 7px 18px 7px 31px; cursor: pointer; transition: background .15s; border-left: 2px solid transparent; }
.sb-item:hover  { background: #161410; }
.sb-item.active { background: #1a1814; border-left-color: var(--paper); }
.sb-item-num { font-family: 'Space Mono', monospace; font-size: 9px; color: #333; flex-shrink: 0; margin-top: 2px; }
.sb-item-text { font-size: 11px; color: #666; line-height: 1.4; }
.sb-item.active .sb-item-text { color: #ccc; }
.sb-item-tags { display: flex; flex-wrap: wrap; gap: 3px; margin-top: 4px; }
.sb-item-tag { font-family: 'Space Mono', monospace; font-size: 8px; padding: 1px 5px; border: 1px solid #222; color: #444; }

/* ============================================================
   STAGE
   ============================================================ */
#stage-wrap { flex: 1; display: flex; flex-direction: column; overflow: hidden; }
#stage { flex: 1; display: flex; align-items: flex-start; justify-content: center; padding: 24px; overflow-y: auto; overflow-x: hidden; }
.slide-frame {
  width: 100%; max-width: 960px;
  /* aspect-ratioは最小高さとして機能させ、コンテンツが多い場合は伸ばす */
  min-height: calc((100vw - var(--sidebar-w) - 48px) * 10 / 16);
  max-height: none;
  background: var(--paper); position: relative; overflow: visible;
  box-shadow: 0 8px 48px rgba(0,0,0,.5);
  flex-shrink: 0;
  margin: auto;
}
#slide-nav { height: 48px; display: flex; align-items: center; justify-content: center; gap: 20px; flex-shrink: 0; padding-bottom: 8px; }
.snav-btn {
  font-family: 'Space Mono', monospace; font-size: 11px; padding: 6px 20px;
  border: 1px solid #333; background: transparent; color: #666;
  cursor: pointer; transition: all .18s; letter-spacing: .08em;
}
.snav-btn:hover:not(:disabled) { color: #ccc; border-color: #666; }
.snav-btn:disabled { opacity: .2; cursor: default; }
#progress-dots { display: flex; gap: 5px; align-items: center; }
.pdot { width: 5px; height: 5px; border-radius: 50%; background: #333; cursor: pointer; transition: all .15s; }
.pdot.active { background: var(--paper); transform: scale(1.3); }

/* preタグのコードブロック — 横スクロール対応 */
pre {
  overflow-x: auto;
  white-space: pre;
  word-wrap: normal;
  -webkit-overflow-scrolling: touch;
}

/* ============================================================
   SLIDE BASE
   ============================================================ */
.slide {
  display: none;
  width: 100%; background: var(--paper); overflow: visible;
}
.slide.active { display: block; animation: fadeSlide .2s ease; }
@keyframes fadeSlide { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }

.slide[data-cat="sys"]   { border-top: 3px solid var(--c1); }
.slide[data-cat="biz"]   { border-top: 3px solid var(--c2); }
.slide[data-cat="think"] { border-top: 3px solid var(--c3); }
.slide[data-cat="pm"]    { border-top: 3px solid var(--c4); }
.slide[data-cat="exec"]  { border-top: 3px solid var(--c5); }

/* ============================================================
   SLIDE PARTS
   ============================================================ */
.s-header { padding: 26px 44px 16px; border-bottom: 1px solid var(--line); display: flex; align-items: baseline; gap: 14px; flex-wrap: wrap; }
.s-tag { font-family: 'Space Mono', monospace; font-size: 9px; padding: 3px 9px; color: #fff; letter-spacing: .12em; flex-shrink: 0; }
.s-title { font-family: 'Noto Serif JP', serif; font-size: 20px; font-weight: 700; color: var(--ink); }
.s-pg { margin-left: auto; font-family: 'Space Mono', monospace; font-size: 10px; color: var(--muted); flex-shrink: 0; }
.s-body { padding: 18px 44px; }

.cover-wrap { height: 100%; background: #0f0e0c; display: flex; flex-direction: column; justify-content: center; padding: 56px 64px; position: relative; }
.cover-eyebrow { font-family: 'Space Mono', monospace; font-size: 10px; color: #444; letter-spacing: .2em; margin-bottom: 28px; }
.cover-h1 { font-family: 'Noto Serif JP', serif; font-size: 46px; font-weight: 900; color: var(--paper); line-height: 1.25; margin-bottom: 18px; }
.cover-sub { font-size: 12px; color: #555; line-height: 1.9; max-width: 420px; }
.cover-pills { position: absolute; right: 64px; top: 50%; transform: translateY(-50%); display: flex; flex-direction: column; gap: 10px; }
.cover-pill { font-family: 'Space Mono', monospace; font-size: 9px; padding: 7px 14px; letter-spacing: .1em; border-left: 2px solid; color: #777; white-space: nowrap; }
.cover-pill:nth-child(1) { border-color: var(--c1); color: #c9896c; }
.cover-pill:nth-child(2) { border-color: var(--c2); color: #6c9ac9; }
.cover-pill:nth-child(3) { border-color: var(--c3); color: #6cc98a; }
.cover-pill:nth-child(4) { border-color: var(--c4); color: #c9a86c; }
.cover-pill:nth-child(5) { border-color: var(--c5); color: #a87cc9; }
.cover-deco { position: absolute; bottom: 0; left: 0; right: 0; height: 3px; background: linear-gradient(90deg, var(--c1) 20%, var(--c2) 20% 40%, var(--c3) 40% 60%, var(--c4) 60% 80%, var(--c5) 80%); }

.div-wrap { height: 100%; display: flex; align-items: center; padding: 50px 60px; gap: 36px; }
.div-num { font-family: 'Noto Serif JP', serif; font-size: 110px; font-weight: 900; line-height: 1; opacity: .05; color: var(--ink); flex-shrink: 0; user-select: none; }
.div-cat-tag { font-family: 'Space Mono', monospace; font-size: 9px; padding: 5px 11px; color: #fff; letter-spacing: .15em; display: inline-block; margin-bottom: 14px; }
.div-h2 { font-family: 'Noto Serif JP', serif; font-size: 34px; font-weight: 700; color: var(--ink); line-height: 1.35; margin-bottom: 12px; }
.div-desc { font-size: 12px; color: var(--muted); line-height: 1.85; max-width: 460px; }
.div-chips { display: flex; flex-wrap: wrap; gap: 5px; margin-top: 16px; }
.div-chip { font-family: 'Space Mono', monospace; font-size: 8px; padding: 3px 9px; border: 1px solid var(--line); color: var(--muted); }

.closer-wrap { height: 100%; background: var(--ink); display: flex; flex-direction: column; justify-content: center; align-items: center; text-align: center; padding: 50px; gap: 16px; position: relative; }
.closer-h { font-family: 'Noto Serif JP', serif; font-size: 30px; font-weight: 700; color: var(--paper); line-height: 1.5; }
.closer-sub { font-size: 12px; color: #555; line-height: 1.9; max-width: 480px; }
.closer-tags { display: flex; flex-wrap: wrap; gap: 5px; justify-content: center; margin-top: 8px; }
.closer-tag { font-family: 'Space Mono', monospace; font-size: 8px; padding: 3px 8px; border: 1px solid #2a2520; color: #444; }

.g2      { display: grid; grid-template-columns: 1fr 1fr;         gap: 10px; }
.g3      { display: grid; grid-template-columns: 1fr 1fr 1fr;     gap: 10px; }
.g4      { display: grid; grid-template-columns: 1fr 1fr 1fr 1fr; gap: 8px; }
.two-col { display: grid; grid-template-columns: 1fr 1fr;         gap: 18px; }

.card { background: #fff; border: 1px solid var(--line); padding: 14px; position: relative; }
.card-bar { position: absolute; top: 0; left: 0; width: 3px; height: 100%; }
.card-name { font-family: 'Space Mono', monospace; font-size: 11px; font-weight: 700; color: var(--ink); margin-bottom: 4px; }
.card-full { font-size: 9px; color: var(--muted); margin-bottom: 6px; }
.card-desc { font-size: 11px; color: #444; line-height: 1.65; }
.card-tags { display: flex; flex-wrap: wrap; gap: 3px; margin-top: 6px; }
.tag { font-family: 'Space Mono', monospace; font-size: 8px; padding: 2px 6px; background: var(--paper); color: var(--muted); }

.tbl { width: 100%; border-collapse: collapse; font-size: 11px; }
.tbl th, .tbl td { padding: 8px 12px; border: 1px solid var(--line); vertical-align: top; }
.tbl th { font-family: 'Space Mono', monospace; font-size: 10px; background: var(--ink); color: var(--paper); letter-spacing: .05em; font-weight: 400; }
.tbl td:first-child { font-family: 'Space Mono', monospace; font-size: 10px; font-weight: 700; background: #fff; white-space: nowrap; }
.tbl tr:nth-child(even) td             { background: #faf8f4; }
.tbl tr:nth-child(even) td:first-child { background: #f5f2ec; }

.cl { list-style: none; }
.cl li { display: flex; gap: 9px; align-items: flex-start; padding: 7px 0; border-bottom: 1px solid var(--line); font-size: 11px; color: #333; line-height: 1.55; }
.cl li:last-child { border-bottom: none; }
.cl li::before { content: '□'; font-family: 'Space Mono', monospace; font-size: 11px; color: #ccc; flex-shrink: 0; }

.raci { width: 100%; border-collapse: collapse; font-size: 11px; }
.raci th, .raci td { padding: 8px 11px; border: 1px solid var(--line); text-align: center; }
.raci th { background: var(--ink); color: var(--paper); font-family: 'Space Mono', monospace; font-size: 9px; font-weight: 400; }
.raci td:first-child { text-align: left; background: #fff; font-size: 11px; }
.rR { background: #fdf0ee; color: var(--c1); font-family: 'Space Mono', monospace; font-weight: 700; }
.rA { background: #e8eef8; color: var(--c2); font-family: 'Space Mono', monospace; font-weight: 700; }
.rC { background: #e8f4ec; color: var(--c3); font-family: 'Space Mono', monospace; font-weight: 700; }
.rI { background: #fdf6e8; color: var(--c4); font-family: 'Space Mono', monospace; font-weight: 700; }

.tree-root { display: inline-block; padding: 8px 14px; background: var(--ink); color: var(--paper); font-family: 'Space Mono', monospace; font-size: 10px; margin-bottom: 12px; }
.tree-row    { display: flex; gap: 8px; }
.tree-branch { flex: 1; display: flex; flex-direction: column; align-items: center; gap: 6px; }
.tree-node   { width: 100%; padding: 7px 8px; text-align: center; font-size: 10px; font-family: 'Space Mono', monospace; border: 1px solid var(--line); background: #fff; }
.tree-conn   { width: 1px; height: 10px; background: var(--line); }
.tree-leaves { display: flex; gap: 5px; width: 100%; }
.tree-leaf   { flex: 1; padding: 5px 6px; text-align: center; font-size: 9px; background: var(--paper); border: 1px solid var(--line); color: #555; }

.qcd-wrap { display: flex; border: 1px solid var(--line); }
.qcd-cell { flex: 1; padding: 18px 16px; position: relative; border-right: 1px solid var(--line); }
.qcd-cell:last-child { border-right: none; }
.qcd-bg-letter { position: absolute; right: 8px; top: 8px; font-family: 'Noto Serif JP', serif; font-size: 44px; font-weight: 900; opacity: .06; line-height: 1; }
.qcd-label { font-family: 'Space Mono', monospace; font-size: 11px; font-weight: 700; margin-bottom: 4px; }
.qcd-jp    { font-size: 16px; font-weight: 700; margin-bottom: 8px; }
.qcd-list  { font-size: 10px; color: #555; line-height: 1.8; }

.m2 { display: grid; grid-template-columns: 1fr 1fr; grid-template-rows: 1fr 1fr; gap: 6px; }
.m2-cell  { padding: 14px; }
.m2-label { font-family: 'Space Mono', monospace; font-size: 10px; font-weight: 700; margin-bottom: 6px; }
.m2-cell ul { padding-left: 13px; font-size: 10px; line-height: 1.75; color: #444; }

.info-box { background: var(--paper); padding: 10px 12px; font-size: 11px; line-height: 1.7; }

.step-flow { display: flex; flex-direction: column; gap: 5px; }
.step-item { display: flex; align-items: center; gap: 10px; }
.step-num  { width: 24px; height: 24px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-family: 'Space Mono', monospace; font-size: 10px; color: #fff; flex-shrink: 0; }
.step-body { flex: 1; padding: 8px 12px; background: #fff; border: 1px solid var(--line); font-size: 11px; line-height: 1.5; }

.label-sm { font-family: 'Space Mono', monospace; font-size: 9px; color: var(--muted); letter-spacing: .12em; }


/* ============================================================
   TABLET (〜 1024px)
   ============================================================ */
@media (max-width: 1024px) {
  :root { --sidebar-w: 220px; }
  .s-header   { padding: 20px 28px 14px; }
  .s-body     { padding: 14px 28px; }
  .cover-wrap { padding: 40px 44px; }
  .cover-h1   { font-size: 36px; }
  .cover-pills { right: 44px; }
  .div-wrap   { padding: 36px 44px; }
  .div-h2     { font-size: 26px; }
  .div-num    { font-size: 80px; }
}


/* ============================================================
   SP (〜 768px)  縦スクロール・カード形式に完全切替
   ============================================================ */
@media (max-width: 768px) {

  /* body: スクロール解放 */
  html { height: auto; }
  body {
    height: auto !important;
    overflow: auto;
    overflow-x: hidden;
    display: block;
  }

  /* Header: sticky */
  #top-header {
    position: sticky; top: 0;
    height: auto; flex-wrap: wrap;
    padding: 10px 14px; gap: 8px;
  }
  .header-title { display: none; }
  .cat-tabs { order: 3; width: 100%; }
  .cat-tab  { font-size: 9px; padding: 4px 9px; }
  /* カウンターはSPでは不要 */
  .header-counter { display: none; }

  /* Main: 通常フロー */
  #main { display: block; height: auto; overflow: visible; }

  /* ---- Sidebar: フルスクリーン ドロワー ---- */
  #sidebar {
    position: fixed !important;
    top: 0; left: 0; bottom: 0;
    width: min(85vw, 320px) !important;
    opacity: 1 !important;
    transform: translateX(-110%);
    transition: transform .3s ease;
    overflow-y: auto;
    border-right: 1px solid #2a2520;
    box-shadow: 4px 0 32px rgba(0,0,0,.7);
    z-index: 999;
  }
  #sidebar.open { transform: translateX(0); }

  /* オーバーレイ */
  #sb-overlay {
    display: none;
    position: fixed; inset: 0;
    background: rgba(0,0,0,.55);
    z-index: 998;
    backdrop-filter: blur(2px);
  }
  #sb-overlay.visible { display: block; }

  /* ---- Stage / Frame ---- */
  #stage-wrap { display: block; overflow: visible; }
  #stage { display: block; padding: 0; height: auto; overflow: visible; }
  #slide-nav { display: none; }  /* PC用ナビ非表示 */

  /* slide-frame: aspect-ratio 解除 */
  .slide-frame {
    aspect-ratio: unset;
    max-width: 100%;
    position: static;
    overflow: visible;
    box-shadow: none;
    background: transparent;
  }

  /* ---- 全スライドを縦に並べる ---- */
  .slide {
    display: block !important;
    position: static !important;
    inset: auto !important;
    width: 100%;
    height: auto !important;
    overflow: visible;
    animation: none !important;
    background: var(--paper);
    margin-bottom: 8px;
  }
  /* フィルタで非表示にする用 */
  .slide.sp-hidden { display: none !important; }

  /* ---- Slide parts ---- */
  .s-header { padding: 16px 18px 12px; }
  .s-title  { font-size: 16px; }
  .s-pg     { display: none; }
  .s-body   { padding: 14px 18px 20px; }

  /* Cover */
  .cover-wrap  { height: auto; min-height: 280px; padding: 36px 22px 44px; }
  .cover-h1    { font-size: 30px; }
  .cover-pills {
    position: static; transform: none;
    flex-direction: row; flex-wrap: wrap;
    gap: 8px; margin-top: 20px;
  }
  .cover-pill { font-size: 9px; padding: 5px 10px; }

  /* Divider */
  .div-wrap { padding: 28px 20px; gap: 0; flex-direction: column; height: auto; }
  .div-num  { font-size: 56px; line-height: 1; margin-bottom: 4px; }
  .div-h2   { font-size: 22px; }
  .div-desc { font-size: 12px; max-width: 100%; }

  /* Closer */
  .closer-wrap { height: auto; min-height: 260px; padding: 40px 22px; }
  .closer-h    { font-size: 22px; }

  /* Grids → 1カラム */
  .g2, .g3, .g4, .two-col { grid-template-columns: 1fr !important; gap: 10px; }

  /* QCD → 縦積み */
  .qcd-wrap { flex-direction: column; }
  .qcd-cell { border-right: none; border-bottom: 1px solid var(--line); }
  .qcd-cell:last-child { border-bottom: none; }

  /* Tables → 横スクロール wrapper */
  .tbl, .raci { display: block; overflow-x: auto; -webkit-overflow-scrolling: touch; font-size: 12px; }
  .tbl thead, .tbl tbody, .raci thead, .raci tbody { display: table; width: 100%; }
  .tbl td:first-child { white-space: normal; }

  /* 2×2 Matrix → 縦積み */
  .m2 { grid-template-columns: 1fr !important; grid-template-rows: unset !important; height: auto !important; gap: 8px; }

  /* Logic Tree → 縦積み */
  .tree-row    { flex-direction: column; gap: 6px; }
  .tree-branch { flex-direction: row; align-items: center; width: 100%; gap: 8px; }
  .tree-node   { flex: 0 0 auto; width: auto; min-width: 80px; }
  .tree-conn   { width: 12px; height: 1px; flex-shrink: 0; }
  .tree-leaves { flex: 1; flex-direction: column; gap: 4px; }
  .tree-leaf   { text-align: left; flex: none; }

  /* height 固定をインラインで書いてある箇所を解除 */
  .slide [style*="height:2"], .slide [style*="height:3"] { height: auto !important; }

  /* フォント少し大きく */
  .card-desc, .cl li, .info-box, .step-body { font-size: 13px; }
  .card-name { font-size: 12px; }

  /* ---- SP用 スクロールナビ (画面下固定) ---- */
  #sp-nav {
    display: flex;
    position: sticky; bottom: 0;
    background: #0a0908;
    border-top: 1px solid #2a2520;
    padding: 10px 16px;
    gap: 10px; align-items: center; justify-content: space-between;
    z-index: 300;
  }
  .sp-nav-btn {
    font-family: 'Space Mono', monospace;
    font-size: 11px; padding: 9px 0;
    border: 1px solid #444; background: transparent; color: #888;
    cursor: pointer; transition: background .15s;
    flex: 1; max-width: 130px; text-align: center;
    -webkit-tap-highlight-color: transparent;
  }
  .sp-nav-btn:active { background: #1a1814; color: #ccc; }
  .sp-nav-btn:disabled { opacity: .25; }
  #sp-counter { font-family: 'Space Mono', monospace; font-size: 10px; color: #555; text-align: center; flex: 1; }
}

/* ============================================================
   SP 極小 (〜 390px)
   ============================================================ */
@media (max-width: 390px) {
  .s-title   { font-size: 14px; }
  .cover-h1  { font-size: 26px; }
  .div-h2    { font-size: 20px; }
  .s-body    { padding: 12px 14px 18px; }
  .s-header  { padding: 14px 14px 10px; }
}
